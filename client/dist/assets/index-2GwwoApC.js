import{u as I,r as a,j as s}from"./index-DWJz4l7w.js";import{c as y,g as w,u as F}from"./dateTimeFormater-BO10k8ZT.js";import{n as C,a as M}from"./investorGrossTotal-BKBBFjPg.js";import{S as T}from"./index-B05lIgl9.js";import{c as D}from"./calculateIrrSingleInvestment-Dz4nqlKD.js";import{g as R}from"./companyService-BDmggvrK.js";import{g as b}from"./AuthService-DjkCPoNv.js";import{M as O}from"./index-DQII9zqX.js";import"./iconBase-BkjdbfSs.js";const J=()=>{I();const[t,e]=a.useState([]);return a.useState([]),a.useEffect(()=>{(async()=>{const r=await w();e(r)})()},[]),s.jsx("div",{children:s.jsxs("table",{className:"ps-5",children:[s.jsx("thead",{className:"thead-dark",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col text-uppercase ",style:{width:"60px",aspectRatio:"1/1"},className:"border-0",children:" "}),s.jsx("th",{scope:"col text-uppercase ",children:" COMPANY "}),s.jsx("th",{scope:"col text-uppercase ",children:"Investor "}),s.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT DATE"}),s.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT"}),s.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(LOSS)"}),s.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),s.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),s.jsx("th",{scope:"col text-uppercase ",children:"Current Shareholding(%) "}),s.jsx("th",{style:{width:"60px",aspectRatio:"1/1"},className:"border-0"})]})}),s.jsx("tbody",{children:t==null?void 0:t.map((c,r)=>{var n;return(n=c==null?void 0:c.investors)==null?void 0:n.map((o,i)=>s.jsxs("tr",{className:"p-3 ",children:[s.jsx(k,{id:c==null?void 0:c.companyId}),s.jsx(A,{deal:c,investor:o,investDate:c==null?void 0:c.investedDate,currentValuation:c==null?void 0:c.currentValue})]},r))})})]})})},k=({id:t})=>{const[e,c]=a.useState(null);return a.useEffect(()=>{t&&(async()=>{const n=await R(t);c(n)})()},[t]),s.jsxs(s.Fragment,{children:[s.jsx("td",{children:s.jsx("div",{onClick:()=>navigate("about",{state:e==null?void 0:e._id}),className:" ms-3",style:{width:"50px",aspectRatio:"1/1"},children:s.jsx("img",{className:"w-100 h-100 rounded-circle",src:T+(e==null?void 0:e.profile)||(e==null?void 0:e.img),alt:""})})}),s.jsx("td",{className:"text-capitalize",children:e==null?void 0:e.name})]})},A=({deal:t,investor:e,investDate:c,currentValuation:r})=>{const[n,o]=a.useState(0),[i,f]=a.useState(0),[u,g]=a.useState(e==null?void 0:e.shareholding),[N,m]=a.useState(!1);a.useEffect(()=>{(async()=>{const h=parseFloat((e==null?void 0:e.amount)||0)+parseFloat((e==null?void 0:e.fees)||0),d=parseFloat((e==null?void 0:e.carried)||0),j=parseFloat((e==null?void 0:e.shareholding)||0),x=await C(h,j,r,t.currency,d/100),E=await M(h,j,r,t.currency,d/100);o(x==null?void 0:x.toFixed(2)),f(E)})()},[t,e,c,r]);const l=a.useRef();a.useEffect(()=>{const p=h=>{l!=null&&l.current&&!(l!=null&&l.current.contains(h.target))&&m(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const S=async p=>{const{value:h}=p.target;t.investors.find(d=>(d==null?void 0:d.investerId)===(e==null?void 0:e.investerId)&&(d==null?void 0:d.profit)===(e==null?void 0:e.profit)).shareholding=parseFloat(h||0),g(h),await F(t==null?void 0:t._id,t)};return s.jsxs(s.Fragment,{children:[s.jsx("td",{children:s.jsx(L,{id:e==null?void 0:e.investerId})}),s.jsx("td",{children:c}),s.jsxs("td",{children:[" ",y(e==null?void 0:e.invest,t==null?void 0:t.currency)]}),s.jsx("td",{children:n}),s.jsxs("td",{children:[" ",i]}),s.jsx("td",{children:s.jsx(P,{initialInvestment:e==null?void 0:e.amount,investmentDate:c,currentValue:r})}),s.jsxs("td",{style:{width:"60px",aspectRatio:"1/1"},children:[" ",s.jsxs("div",{className:"d-flex field ",ref:l,children:[" ",N?s.jsx("input",{type:"text",className:"input-field py-2 me-3",value:u,onChange:S}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"d-flex gap-3",children:[s.jsxs("span",{children:[u,"%"]})," ",s.jsx(O,{className:"text-danger",onClick:()=>m(!0),style:{cursor:"pointer"},size:20}),"  "]})})]})]})]})},L=({id:t})=>{var r,n;const[e,c]=a.useState(null);return a.useEffect(()=>{t&&(async()=>{const i=await b(t);c(i)})()},[t]),console.log(e),s.jsxs(s.Fragment,{children:[" ",(r=e==null?void 0:e.personal)==null?void 0:r.firstName," ",(n=e==null?void 0:e.personal)==null?void 0:n.lastName]})},P=({initialInvestment:t,investmentDate:e,currentValue:c})=>{const[r,n]=a.useState(0);return a.useEffect(()=>{n(D(parseInt(t||0),new Date(e),parseInt(c||0),new Date))},[t,e,c]),s.jsxs(s.Fragment,{children:[" ",r]})};export{J as default};
