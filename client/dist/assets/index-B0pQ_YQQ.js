import{r as n,g as Y,j as e}from"./index-CK4vFJw6.js";import{N as Z,D as z,e as G,n as H,a as K,p as v,c as k}from"./netProfit-DsRGFS4I.js";import{g as W}from"./companyService-BsFuag96.js";import{c as b,a as X}from"./dealService-DQR-YRBo.js";import{S as $}from"./index-BASRcFmR.js";import"./index-V6NroyKG.js";import"./iconBase-DkHDt37A.js";const Q="/assets/investment-DZaxrG47.png",ee="/assets/examination-DLEo242M.png",te="/assets/receive-money-BX_SY2uW.png",se="/assets/distribution-of-wealth-BkfwJAiH.png",re="/assets/increase-BlPrZrvo.png",ne="/assets/return-on-investment-hb7KJEPm.png",xe=()=>{var E,N;const[c,h]=n.useState([]),[R,i]=n.useState(0),[d,t]=n.useState(0),[V,M]=n.useState(0),[m,A]=n.useState(1),[L,O]=n.useState(0),[D,I]=n.useState(0),[T,y]=n.useState(0),u=(N=(E=Y())==null?void 0:E.user)==null?void 0:N._id,j=[{name:" TOTAL INVESTMENTS",qty:R,icon:Q},{name:"  CURRENT VALUATION",qty:b(V*m),icon:ee},{name:"   AMOUNT INVESTED (INCL. FEES)",qty:b(d*m),icon:te},{name:"  NET MOIC",qty:((D||0)*100).toFixed(2)+"%",icon:se},{name:" NET PROFIT (LOSS)",qty:b(L),icon:re},{name:"  NET IRR",qty:T,icon:ne}];return n.useEffect(()=>{(async()=>{var P;const o=await X(u);let p=0,w=0,l=0,x=0;for(const S of o)for(const r of S==null?void 0:S.deals){const U=await G(r==null?void 0:r.currency);A(U);const a=(P=r==null?void 0:r.investors)==null?void 0:P.find(g=>g.investerId===u);if(a){x+=1;const g=parseInt((a==null?void 0:a.amount)||0)+parseFloat((a==null?void 0:a.fees)||0),B=parseFloat((a==null?void 0:a.carried)||0),q=parseFloat((a==null?void 0:a.shareholding)||0),_=await H(g,q,parseInt((r==null?void 0:r.currentValue)||0),r.currency,B/100),J=await K(g,q,parseInt((r==null?void 0:r.currentValue)||0),r.currency,B/100);p+=_,w+=J,l+=g}}O(p),I(w),t(l),M(l+p),h(o),i(x);const{totalCurrentValue:f,currentDate:C,investments:F}=v(o,u);if(f&&C&&F){const S=k(F,C,f);y(S)}})()},[u]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"container w-100 pe-0",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"row row-cols-3 pe-0",children:j==null?void 0:j.map((s,o)=>e.jsx("div",{className:"px-0",children:e.jsxs("div",{className:`d-flex p-2 border border-1 mb-3 ${o%3!==0&&"mx-3"} rounded-1 border-dark bg-white  justify-content-between`,children:[e.jsxs("div",{className:"d-flex flex-column gap-2 justify-content-between",children:[e.jsx("span",{className:"text-muted small",children:s==null?void 0:s.name}),e.jsx("span",{className:"fw-bold ",children:s==null?void 0:s.qty})]}),e.jsx("div",{className:"my-auto  rounded-circle bg-very-light-red",style:{width:"40px",aspectRatio:"1/1"},children:e.jsx("img",{className:"w-100 h-100 p-2",src:s==null?void 0:s.icon,alt:""})})]})},o))})})})}),e.jsxs("div",{className:"h-50",children:[e.jsx("div",{className:"my-3",children:e.jsx("div",{className:"bg-dark py-4 px-5 rounded d-flex justify-content-between",children:e.jsx("h5",{className:"text-white",children:"Investments"})})}),e.jsx("div",{className:"bg-white h-50",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col text-uppercase ",children:" "}),e.jsx("th",{scope:"col text-uppercase ",children:" COMPANY"}),e.jsx("th",{scope:"col text-uppercase",children:"ASSET CLASS"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(Loss)"}),e.jsx("th",{scope:"col text-uppercase ",children:"SECTOR"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),e.jsx("th",{scope:"col text-uppercase ",children:"TOTAL INVESTMENT"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),e.jsx("th",{scope:"col text-uppercase ",children:"NUMBER OF INVESTMENTS "})]})}),e.jsx("tbody",{children:c&&c.length>0&&(c==null?void 0:c.map((s,o)=>e.jsx(ae,{list:c,index:o,companyId:s==null?void 0:s._id,userId:u,deals:s==null?void 0:s.deals})))})]})})]})]})},ae=({companyId:c,list:h,index:R,deals:i,userId:d})=>{var I,T,y;const[t,V]=n.useState(null),[M,m]=n.useState(!1),[A,L]=n.useState(0),[O,D]=n.useState(0);return console.log(c),n.useEffect(()=>{(async()=>{const j=await W(c);V(j),L(()=>i.reduce((w,l)=>{var f;const x=(f=l==null?void 0:l.investors)==null?void 0:f.find(C=>C.investerId===d);return w+parseInt((x==null?void 0:x.amount)||0)},0));const E=h==null?void 0:h.filter(p=>p._id===c),{totalCurrentValue:N,currentDate:s,investments:o}=v(E,d);N&&s&&o&&D(k(o,s,N))})()},[c]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{className:" ",style:{width:"50px",aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:$+(t==null?void 0:t.profile)||(t==null?void 0:t.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize",children:t==null?void 0:t.name}),e.jsx("td",{children:(I=t==null?void 0:t.dealSummary)==null?void 0:I.asset}),e.jsx(Z,{deals:i,userId:d,currentValuation:(T=t==null?void 0:t.dealSummary)==null?void 0:T.currentValuation,sector:(y=t==null?void 0:t.dealSummary)==null?void 0:y.sector}),e.jsx("td",{children:b(A)}),e.jsx("td",{children:O}),e.jsx("td",{className:"d-flex gap-3",children:e.jsxs("button",{onClick:()=>m(!0),className:"btn-red",children:[i&&(i==null?void 0:i.length)," Investments"]})})]},R),M&&e.jsx(z,{userId:d,company:t,deals:i,setIsNew:m})]})};export{xe as default};
