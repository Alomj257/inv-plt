import{r as c,j as e,u as R}from"./index-BMOHnWt5.js";import{a as k,c as T}from"./index-JLkZSaV7.js";import{B as F,a as V}from"./index-D-rva_mX.js";import{b as _,c as w}from"./dealService-DOnlFLCB.js";import{a as z}from"./AuthService-Dwej2ar9.js";import{g as B,u as O,a as $,d as J}from"./companyService-BITD3uGn.js";import{S as L}from"./index-BICwPsy_.js";import{g as M}from"./index-Cni1xWr3.js";import"./iconBase-B76WCjS1.js";const P=({setIsNew:m,companyId:l,reFetch:u})=>{const[r,p]=c.useState({}),[i,h]=c.useState([]),[d,b]=c.useState([]),[C,t]=c.useState(""),[o,x]=c.useState("");c.useEffect(()=>{(async()=>{const a=await B(l);x(a)})()},[l]),c.useEffect(()=>{(async()=>{const a=await z("CUSTOMER");b(a)})()},[]);const S=()=>{h([...i,{name:"",amount:"",entryFee:"",carried:""}])},v=n=>{const a=i.filter((s,j)=>j!==n);h(a)},g=(n,a)=>{const{name:s,value:j}=a.target,f=i.map((y,E)=>{if(E===n){const N={...y,[s]:j},I=parseInt(N.amount||0),A=parseInt(N.entryFee||0),U=parseInt(N.carried||0);return N.fees=I*(A+U)/100,N}return y});h(f)},D=async n=>{n.preventDefault();const a={...r,investors:i,companyId:l};let s;!o.dealSummary||!o.dealSummary.investDate?s=r==null?void 0:r.investedDate:s=o==null?void 0:o.dealSummary.investDate,await O(l,{investDate:s,currentValuation:r==null?void 0:r.currentValue}),await _(a)&&(u(),m(!1))};return console.log(i),e.jsx("div",{className:"pop",children:e.jsxs("div",{className:"pop-body col-8 pb-5",children:[e.jsx("div",{className:"text-end",children:e.jsx(F,{onClick:()=>m(n=>!n),className:"cursor-pointer",size:30})}),e.jsx("h5",{className:"text-center mb-4 fs-4",children:"Add a deal"}),e.jsx("form",{onSubmit:D,children:e.jsxs("div",{className:"d-flex flex-column gap-4 col-md-10 mx-auto",children:[e.jsxs("div",{className:"d-flex gap-4 align-items-center",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"valuation",children:"Current valuation"}),e.jsx("input",{type:"text",name:"valuation",value:r==null?void 0:r.currentValue,onChange:n=>p({...r,currentValue:n.target.value}),className:"input-field"})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"date",children:"Investment date"}),e.jsx("input",{type:"date",name:"date",onChange:n=>p({...r,investedDate:n.target.value}),className:"input-field"})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"date",children:"Currency"}),e.jsxs("select",{onChange:n=>t(JSON.parse(n.target.value)),name:"",id:"",className:"input-field",children:[e.jsx("option",{value:JSON.stringify({currency:"EUR"}),children:"Euro"}),e.jsx("option",{value:JSON.stringify({currency:"USD"}),children:"US Dollar"})]})]})]}),i.map((n,a)=>e.jsxs("div",{className:"d-flex gap-4 align-items-center",children:[e.jsxs("div",{className:"field w-50",children:[e.jsx("label",{htmlFor:`name-${a}`,children:"Select Investors"}),e.jsx("div",{className:"input-field w-100",children:e.jsxs("select",{name:"investerId",value:n.investerId,onChange:s=>g(a,s),style:{outline:"none"},className:"border-0 bg-transparent w-100",children:[e.jsx("option",{value:"",children:"Select Investor"}),(d==null?void 0:d.length)>0&&d.map((s,j)=>{var f,y;return e.jsxs("option",{value:s==null?void 0:s._id,children:[(f=s==null?void 0:s.personal)==null?void 0:f.firstName," ",(y=s==null?void 0:s.personal)==null?void 0:y.lastName]},j)})]})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:`amount-${a}`,children:"Amount invested"}),e.jsx("input",{type:"text",name:"amount",value:n.amount,className:"input-field",onChange:s=>g(a,s)})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:`entryFee-${a}`,children:"Entry Fee in %"}),e.jsx("input",{type:"text",name:"entryFee",value:n.entryFee,className:"input-field",onChange:s=>g(a,s)})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:`carried-${a}`,children:"Carried in %"}),e.jsx("input",{type:"text",name:"carried",value:n.carried,className:"input-field",onChange:s=>g(a,s)})]}),e.jsxs("div",{className:"d-flex gap-2 mt-auto align-items-center",children:[e.jsx("button",{type:"button",onClick:S,style:{width:"50px",aspectRatio:"1/1"},className:"btn-red p-0 rounded-circle",children:e.jsx(V,{size:20})}),e.jsx("button",{type:"button",style:{width:"50px",aspectRatio:"1/1"},onClick:()=>v(a),className:"btn-gray p-0 rounded-circle",children:e.jsx(F,{size:20})})]})]},a)),i.length<=0&&e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",className:"btn-red rounded-5 col-5",onClick:S,children:"Add an investor"})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"submit",className:`btn-${i.length<=0?"gray":"red"} rounded-5 col-5`,children:"Save"})})]})})]})})},te=()=>{const[m,l]=c.useState(!1),[u,r]=c.useState([]),[p,i]=c.useState(""),h=R(),d=async()=>{const t=await $();r(t)};c.useEffect(()=>{d()},[]);const b=async t=>{r(o=>o.filter(x=>x._id!==t)),await J(t)},C=()=>{d()};return e.jsxs("div",{className:"bg-white company h-100 ",children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Logo"}),e.jsx("th",{scope:"col",children:"Name"}),e.jsx("th",{scope:"col",children:"CUMULATED INVESTMENT"}),e.jsx("th",{scope:"col",children:"CURRENT VALUATION "}),e.jsx("th",{scope:"col"})]})}),e.jsx("tbody",{children:u&&(u==null?void 0:u.map((t,o)=>{var x;return e.jsxs("tr",{className:" ",children:[e.jsx("td",{children:e.jsxs("div",{style:{width:"60px",aspectRatio:"1/1"},children:["   ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:L+(t==null?void 0:t.profile),alt:""})]})}),e.jsx("td",{className:"text-uppercase ",children:t==null?void 0:t.name}),e.jsx(W,{id:t==null?void 0:t._id}),e.jsxs("td",{children:[" ",w((x=t==null?void 0:t.dealSummary)==null?void 0:x.currentValuation)]}),e.jsxs("td",{className:"d-flex gap-4",children:[e.jsx("button",{className:"btn-red",onClick:()=>{l(!m),i(t==null?void 0:t._id)},children:"Create a deal"}),e.jsx("button",{onClick:()=>h("new-company",{state:t==null?void 0:t._id}),className:"btn text-primary bg-very-light-gray rounded-circle",children:e.jsx(k,{size:20})}),e.jsx("button",{onClick:()=>b(t==null?void 0:t._id),className:"btn text-danger bg-very-light-gray rounded-circle",children:e.jsx(T,{size:20})})]})]},o)}))})]}),m&&e.jsx(P,{reFetch:C,companyId:p,setIsNew:l})]})},W=({id:m})=>{const[l,u]=c.useState(0),[r,p]=c.useState(0);return c.useEffect(()=>{(async()=>{const{totalInvestment:h,current:d}=await M(m);u(h),p(d)})()},[m]),e.jsx(e.Fragment,{children:e.jsxs("td",{children:[" ",w(l)]})})};export{te as default};
