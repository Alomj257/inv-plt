import{r,g as J,j as e}from"./index-BMOHnWt5.js";import{N as Y,D as Z,p as _,c as k}from"./netProfit-BGQhv2TS.js";import{a as z,g as G}from"./companyService-BITD3uGn.js";import{c as C,a as H}from"./dealService-DOnlFLCB.js";import{S as K}from"./index-BICwPsy_.js";import"./index-D-rva_mX.js";import"./iconBase-B76WCjS1.js";const W="/assets/investment-DZaxrG47.png",X="/assets/examination-DLEo242M.png",$="/assets/receive-money-BX_SY2uW.png",Q="/assets/distribution-of-wealth-BkfwJAiH.png",ee="/assets/increase-BlPrZrvo.png",te="/assets/return-on-investment-hb7KJEPm.png",de=()=>{var D,T;const[a,S]=r.useState([]),[b,o]=r.useState(0),[u,t]=r.useState(0),[A,V]=r.useState(0),[g,M]=r.useState(0),[R,L]=r.useState(0),[O,y]=r.useState(0),l=(T=(D=J())==null?void 0:D.user)==null?void 0:T._id,m=[{name:" TOTAL INVESTMENTS",qty:b,icon:W},{name:"  CURRENT VALUATION",qty:C(A),icon:X},{name:"   AMOUNT INVESTED (INCL. FEES)",qty:C(u),icon:$},{name:"  NET MOIC",qty:((R||0)*100).toFixed(2)+"%",icon:Q},{name:" NET PROFIT (LOSS)",qty:C(g),icon:ee},{name:"  NET IRR",qty:O,icon:te}];return r.useEffect(()=>{(async()=>{const n=await H(l),x=await z();let p=0;Array.isArray(n)&&n.forEach(i=>{const c=x==null?void 0:x.find(d=>(d==null?void 0:d._id)===(i==null?void 0:i._id));c&&c.dealSummary&&(p+=parseInt(c.dealSummary.currentValuation||0))});const E=n==null?void 0:n.reduce((i,c)=>{var d;return i+(((d=c==null?void 0:c.deals)==null?void 0:d.length)||0)},0),h=n==null?void 0:n.reduce((i,c)=>{var F;const d=(F=c==null?void 0:c.deals)==null?void 0:F.reduce((U,P)=>{var q;const f=(q=P==null?void 0:P.investors)==null?void 0:q.find(B=>(B==null?void 0:B.investerId)===l);return U+parseInt((f==null?void 0:f.amount)||0)+parseInt((f==null?void 0:f.fees)||0)},0);return i+d},0),{totalCurrentValue:j,currentDate:N,investments:I}=_(n,l);if(j&&N&&I){const i=k(I,N,j);y(i)}V(p),o(E),t(h),S(n);const w=p-h;M(w);const v=(w+h)/h;L(v)})()},[l]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"container w-100 pe-0",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"row row-cols-3 pe-0",children:m==null?void 0:m.map((s,n)=>e.jsx("div",{className:"px-0",children:e.jsxs("div",{className:`d-flex p-2 border border-1 mb-3 ${n%3!==0&&"mx-3"} rounded-1 border-dark bg-white  justify-content-between`,children:[e.jsxs("div",{className:"d-flex flex-column gap-2 justify-content-between",children:[e.jsx("span",{className:"text-muted small",children:s==null?void 0:s.name}),e.jsx("span",{className:"fw-bold ",children:s==null?void 0:s.qty})]}),e.jsx("div",{className:"my-auto  rounded-circle bg-very-light-red",style:{width:"40px",aspectRatio:"1/1"},children:e.jsx("img",{className:"w-100 h-100 p-2",src:s==null?void 0:s.icon,alt:""})})]})},n))})})})}),e.jsxs("div",{className:"h-50",children:[e.jsx("div",{className:"my-3",children:e.jsx("div",{className:"bg-dark py-4 px-5 rounded d-flex justify-content-between",children:e.jsx("h5",{className:"text-white",children:"Investments"})})}),e.jsx("div",{className:"bg-white h-50",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col text-uppercase ",children:" "}),e.jsx("th",{scope:"col text-uppercase ",children:" COMPANY"}),e.jsx("th",{scope:"col text-uppercase",children:"ASSET CLASS"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(Loss)"}),e.jsx("th",{scope:"col text-uppercase ",children:"SECTOR"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),e.jsx("th",{scope:"col text-uppercase ",children:"TOTAL INVESTMENT"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),e.jsx("th",{scope:"col text-uppercase ",children:"NUMBER OF INVESTMENTS "})]})}),e.jsx("tbody",{children:a&&a.length>0&&(a==null?void 0:a.map((s,n)=>e.jsx(se,{list:a,index:n,companyId:s==null?void 0:s._id,userId:l,deals:s==null?void 0:s.deals})))})]})})]})]})},se=({companyId:a,list:S,index:b,deals:o,userId:u})=>{var y,l,m;const[t,A]=r.useState(null),[V,g]=r.useState(!1),[M,R]=r.useState(0),[L,O]=r.useState(0);return r.useEffect(()=>{(async()=>{const T=await G(a);A(T),R(()=>o.reduce((h,j)=>{var I;const N=(I=j==null?void 0:j.investors)==null?void 0:I.find(w=>w.investerId===u);return h+parseInt((N==null?void 0:N.amount)||0)},0));const s=S==null?void 0:S.filter(E=>E._id===a),{totalCurrentValue:n,currentDate:x,investments:p}=_(s,u);n&&x&&p&&O(k(p,x,n))})()},[a]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{className:" ",style:{width:"50px",aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:K+(t==null?void 0:t.profile)||(t==null?void 0:t.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize",children:t==null?void 0:t.name}),e.jsx("td",{children:(y=t==null?void 0:t.dealSummary)==null?void 0:y.asset}),e.jsx(Y,{deals:o,userId:u,currentValuation:(l=t==null?void 0:t.dealSummary)==null?void 0:l.currentValuation,sector:(m=t==null?void 0:t.dealSummary)==null?void 0:m.sector}),e.jsx("td",{children:C(M)}),e.jsx("td",{children:L}),e.jsx("td",{className:"d-flex gap-3",children:e.jsxs("button",{onClick:()=>g(!0),className:"btn-red",children:[o&&(o==null?void 0:o.length)," Investments"]})})]},b),V&&e.jsx(Z,{userId:u,company:t,deals:o,setIsNew:g})]})};export{de as default};
