import{r,g as J,c as C,j as e,S as Y,f as Z,C as G,o as H,p as K,h as W}from"./index-Dll_1HP0.js";import{N as X,D as $,p as q,c as v}from"./netProfit-k_3AtA2x.js";import{I as Q}from"./index-CdD0VRYO.js";import"./index-CAi8zhoe.js";import"./iconBase-D8TNORit.js";const ee="/assets/investment-DZaxrG47.png",te="/assets/examination-DLEo242M.png",se="/assets/receive-money-BX_SY2uW.png",ne="/assets/distribution-of-wealth-BkfwJAiH.png",re="/assets/increase-BlPrZrvo.png",ae="/assets/return-on-investment-hb7KJEPm.png",xe=()=>{var w,N;const[c,p]=r.useState([]),[b,i]=r.useState(0),[d,t]=r.useState(0),[R,V]=r.useState(0),[M,A]=r.useState(1),[F,L]=r.useState(0),[O,S]=r.useState(0),[y,I]=r.useState(0),h=(N=(w=J())==null?void 0:w.user)==null?void 0:N._id,j=[{name:" TOTAL INVESTMENTS",qty:b,icon:ee},{name:"  CURRENT VALUATION",qty:C(R),icon:te},{name:"   AMOUNT INVESTED (INCL. FEES)",qty:C(d),icon:se},{name:"  NET MOIC",qty:O||0,icon:ne},{name:" NET PROFIT (LOSS)",qty:C(F),icon:re},{name:"  NET IRR",qty:y,icon:ae}];return r.useEffect(()=>{(async()=>{var P;const o=await Z(h);let x=0,T=0,l=0,u=0;for(const g of o)for(const n of g==null?void 0:g.deals){const U=await G(n==null?void 0:n.currency);A(U);const a=(P=n==null?void 0:n.investors)==null?void 0:P.find(m=>m.investerId===h);if(a){u+=1;const m=parseFloat((a==null?void 0:a.amount)||0)+parseFloat((a==null?void 0:a.fees)||0),B=parseFloat((a==null?void 0:a.carried)||0),k=parseFloat((a==null?void 0:a.shareholding)||0);console.log(m);const _=await H(m,k,parseInt((n==null?void 0:n.currentValue)||0),n.currency,B/100),z=await K(m,k,parseInt((n==null?void 0:n.currentValue)||0),n.currency,B/100);x+=_,T+=z,l+=m}}L(x),S(T),t(l),V(l+x),p(o),i(u);const{totalCurrentValue:f,currentDate:E,investments:D}=q(o,h);if(f&&E&&D){const g=v(D,E,f);I(g)}})()},[h]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"container w-100 pe-0",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"row row-cols-3 pe-0",children:j==null?void 0:j.map((s,o)=>e.jsx("div",{className:"px-0",children:e.jsxs("div",{className:`d-flex p-2 border border-1 mb-3 ${o%3!==0&&"mx-3"} rounded-1 border-dark bg-white  justify-content-between`,children:[e.jsxs("div",{className:"d-flex flex-column gap-2 justify-content-between",children:[e.jsx("span",{className:"text-muted small",children:s==null?void 0:s.name}),e.jsx("span",{className:"fw-bold ",children:s==null?void 0:s.qty})]}),e.jsx("div",{className:"my-auto  rounded-circle bg-very-light-red",style:{width:"40px",aspectRatio:"1/1"},children:e.jsx("img",{className:"w-100 h-100 p-2",src:s==null?void 0:s.icon,alt:""})})]})},o))})})})}),e.jsxs("div",{className:"h-50",children:[e.jsx("div",{className:"my-3",children:e.jsx("div",{className:"bg-dark py-4 px-5 rounded d-flex justify-content-between",children:e.jsx("h5",{className:"text-white",children:"Investments"})})}),e.jsx("div",{className:"bg-white h-50",children:e.jsxs("table",{children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col ",style:{width:"60px",aspectRatio:"1/1"},className:"border-0",children:" "}),e.jsx("th",{scope:"col ",children:" COMPANY"}),e.jsx("th",{scope:"col",children:"ASSET CLASS"}),e.jsx("th",{scope:"col ",children:"NET PROFIT(Loss)"}),e.jsx("th",{scope:"col ",children:"SECTOR"}),e.jsx("th",{scope:"col ",children:"NET MOIC"}),e.jsx("th",{scope:"col ",children:"TOTAL INVESTMENT"}),e.jsx("th",{scope:"col ",children:"NET IRR "}),e.jsx("th",{scope:"col ",children:"NUMBER OF INVESTMENTS "}),e.jsx("th",{style:{width:"60px",aspectRatio:"1/1"},className:"border-0"})]})}),e.jsx("tbody",{children:c&&c.length>0&&(c==null?void 0:c.map((s,o)=>e.jsx(ce,{list:c,index:o,companyId:s==null?void 0:s._id,userId:h,deals:s==null?void 0:s.deals})))})]})})]})]})},ce=({companyId:c,list:p,index:b,deals:i,userId:d})=>{var S,y,I;const[t,R]=r.useState(null),[V,M]=r.useState(!1),[A,F]=r.useState(0),[L,O]=r.useState(0);return console.log(c),r.useEffect(()=>{(async()=>{const j=await W(c);R(j),F(()=>i.reduce((T,l)=>{var f;const u=(f=l==null?void 0:l.investors)==null?void 0:f.find(E=>E.investerId===d);return T+parseInt((u==null?void 0:u.amount)||0)},0));const w=p==null?void 0:p.filter(x=>x._id===c),{totalCurrentValue:N,currentDate:s,investments:o}=q(w,d);N&&s&&o&&O(v(o,s,N))})()},[c]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{className:" ms-2",style:{width:"50px",aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:Y+(t==null?void 0:t.profile)||(t==null?void 0:t.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize",children:t==null?void 0:t.name}),e.jsx("td",{children:(S=t==null?void 0:t.dealSummary)==null?void 0:S.asset}),e.jsx(X,{deals:i,userId:d,currentValuation:(y=t==null?void 0:t.dealSummary)==null?void 0:y.currentValuation,sector:(I=t==null?void 0:t.dealSummary)==null?void 0:I.sector}),e.jsx("td",{children:C(A)}),e.jsx("td",{children:L}),e.jsx("td",{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsxs("button",{onClick:()=>M(!0),className:"btn-dark d-flex justify-content-center gap-2 align-items-center",children:[i&&(i==null?void 0:i.length)," ",e.jsxs("div",{style:{width:"25px",aspectRatio:"1/1"},className:" rounded-circle bg-dark-orange",children:[" ",e.jsx(Q,{size:10})]})]})})}),e.jsx("td",{style:{width:"50px",aspectRatio:"1/1"}})]},b),V&&e.jsx($,{userId:d,company:t,deals:i,setIsNew:M})]})};export{xe as default};
