import{r as S,j as e,u as m,g as R}from"./index-BMOHnWt5.js";import{B as V}from"./index-D-rva_mX.js";import{S as b}from"./index-BICwPsy_.js";import{g as M,c as O}from"./dealService-DOnlFLCB.js";const W=(o,s)=>{try{let n=0;const r=[];return o.forEach(c=>{var d;(d=c==null?void 0:c.deals)==null||d.forEach(t=>{var N;n+=parseInt((t==null?void 0:t.currentValue)||0);const u=(N=t==null?void 0:t.investors)==null?void 0:N.find(f=>(f==null?void 0:f.investerId)===s);u&&r.push([parseInt((u==null?void 0:u.amount)||0),new Date(t==null?void 0:t.investedDate)])})}),{totalCurrentValue:n,currentDate:new Date,investments:r}}catch(n){return console.log(n),null}};function X(o,s,n){let r=0,a=0;return o.forEach(([d,t])=>{r+=d;const u=(s-t)/(365*24*60*60*1e3);a+=d/r*u}),(((n/r)**(1/a)-1)*100).toFixed(1)}function _(o,s,n,r){const a=(r-s)/31536e6;return(((n/o)**(1/a)-1)*100).toFixed(4)}const k=(o,s,n,r)=>{try{const c=s/776e5*100,d=n/r*100;return(c*o*d).toFixed(2)}catch(a){return console.log(a),0}},A=(o,s,n,r,a,c)=>{try{const d=k(o,s,n,r),t=s+a;return d-t<=0?(d-t).toFixed(2):(d-t)*(1-(c||0)).toFixed(2)}catch(d){return console.log(d),0}},C=(o,s,n,r,a,c)=>{const d=s+a;return((A(o,s,n,r,a,c)+d)/d).toFixed(2)},B=({deal:o,sector:s,currentValuation:n,userId:r})=>{const[a,c]=S.useState(0),[d,t]=S.useState(0),[u,N]=S.useState(0);return S.useEffect(()=>{(async()=>{const g=await M(r);N(()=>g.reduce((l,i)=>{var I;const h=(I=i==null?void 0:i.investors)==null?void 0:I.find(E=>E.investerId===r);return l+parseInt((h==null?void 0:h.amount)||0)},0))})()},[r]),S.useEffect(()=>{var x,j;let f=0,g=0,p=0,l=0;const i=(x=o==null?void 0:o.investors)==null?void 0:x.find(T=>T.investerId===r);i&&(f+=parseInt((i==null?void 0:i.amount)||0),g+=parseInt((i==null?void 0:i.fees)||0),l+=parseInt((i==null?void 0:i.carried)||0));const h=(j=o==null?void 0:o.investors)==null?void 0:j.reduce((T,D)=>T+parseInt((D==null?void 0:D.amount)||0),0);p+=h;const I=A(n,u,f,p,g,l/100),E=C(n,u,f,p,g,l/100);c(I),t(E)},[n,r,o,u]),e.jsxs(e.Fragment,{children:[e.jsxs("td",{children:["  ",a]}),e.jsx("td",{children:s}),e.jsx("td",{children:d})]})},$=({setIsNew:o,company:s,deals:n,userId:r})=>{var d;const a=m(),c=(d=R())==null?void 0:d.user;return console.log(n),e.jsx("div",{className:"pop",children:e.jsxs("div",{className:"pop-body col-md-10",children:[e.jsx("div",{className:"text-end",children:e.jsx(V,{onClick:()=>o(t=>!t),className:"cursor-pointer",size:30})}),e.jsx("div",{className:"",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col text-uppercase ",children:" "}),e.jsx("th",{scope:"col text-uppercase ",children:" DEAL NAME"}),e.jsx("th",{scope:"col text-uppercase ",children:"ASSET ClASS "}),e.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT DATE"}),e.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(LOSS)"}),e.jsx("th",{scope:"col text-uppercase ",children:"SECTOR"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),e.jsx("th",{scope:"col text-uppercase ",children:"WEIGHT "})]})}),e.jsx("tbody",{children:n==null?void 0:n.map((t,u)=>{var N,f,g,p,l,i,h,I,E;return e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{onClick:()=>a("about",{state:s==null?void 0:s._id}),className:" ",style:{width:"50px",aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:b+(s==null?void 0:s.profile)||(s==null?void 0:s.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize",children:s==null?void 0:s.name}),e.jsx("td",{children:(N=s==null?void 0:s.dealSummary)==null?void 0:N.asset}),e.jsx("td",{children:t==null?void 0:t.investedDate}),e.jsxs("td",{children:[" ",O((t==null?void 0:t.investors)&&((g=(f=t==null?void 0:t.investors)==null?void 0:f.find(x=>x.investerId===(c==null?void 0:c._id)))==null?void 0:g.amount)||(t==null?void 0:t.investors)&&((l=(p=t==null?void 0:t.investors)==null?void 0:p.find(x=>x.investerId===r))==null?void 0:l.amount))]}),e.jsx(B,{deal:t,currentValuation:(i=s==null?void 0:s.dealSummary)==null?void 0:i.currentValuation,userId:r||(c==null?void 0:c._id),sector:(h=s==null?void 0:s.dealSummary)==null?void 0:h.sector}),e.jsx("td",{children:e.jsx(L,{initialInvestment:(t==null?void 0:t.investors)&&((E=(I=t==null?void 0:t.investors)==null?void 0:I.find(x=>x.investerId===(r||(c==null?void 0:c._id))))==null?void 0:E.amount),investmentDate:t==null?void 0:t.investedDate,currentValue:t==null?void 0:t.currentValue})}),e.jsx("td",{children:t==null?void 0:t.weight})]},u)})})]})})]})})},L=({initialInvestment:o,investmentDate:s,currentValue:n})=>{const[r,a]=S.useState(0);return S.useEffect(()=>{a(_(parseInt(o||0),new Date(s),parseInt(n||0),new Date))},[o,s,n]),e.jsxs(e.Fragment,{children:[" ",r]})},q=({deals:o,sector:s,currentValuation:n,userId:r})=>{const[a,c]=S.useState(0),[d,t]=S.useState(0),[u,N]=S.useState(0),f=async()=>{const p=(await M(r)).reduce((l,i)=>{var I;const h=(I=i==null?void 0:i.investors)==null?void 0:I.find(E=>E.investerId===r);return l+parseInt((h==null?void 0:h.amount)||0)},0);N(p)};return S.useEffect(()=>{const g=()=>{let p=0,l=0,i=0,h=0;o.forEach(x=>{var D,w;const j=(D=x==null?void 0:x.investors)==null?void 0:D.find(P=>P.investerId===r);j&&(p+=parseInt((j==null?void 0:j.amount)||0),l+=parseInt((j==null?void 0:j.fees)||0),h+=parseInt((j==null?void 0:j.carried)||0));const T=(w=x==null?void 0:x.investors)==null?void 0:w.reduce((P,F)=>P+parseInt((F==null?void 0:F.amount)||0),0);i+=T});const I=A(n,u,p,i,l,h/100),E=C(n,u,p,i,l,h/100);c(I),t(E)};f().then(()=>g())},[n,r,o,u]),e.jsxs(e.Fragment,{children:[e.jsx("td",{children:a}),e.jsx("td",{children:s}),e.jsx("td",{children:d})]})};export{$ as D,q as N,X as c,W as p};
