import{r as I,j as e,u as F,g as M}from"./index-tGqmFr2s.js";import{B as m}from"./index-DFboXxjU.js";import{S as R}from"./index-DwED7RO3.js";import{g as D,c as C}from"./dealService-B78jylFK.js";import{n as P,a as T}from"./investorGrossTotal-5VNPN936.js";const Y=(o,s)=>{try{let c=0;const r=[];return o.forEach(d=>{var f;(f=d==null?void 0:d.deals)==null||f.forEach(t=>{var S;c+=parseInt((t==null?void 0:t.currentValue)||0);const p=(S=t==null?void 0:t.investors)==null?void 0:S.find(N=>(N==null?void 0:N.investerId)===s);p&&r.push([parseInt((p==null?void 0:p.amount)||0),new Date(t==null?void 0:t.investedDate)])})}),{totalCurrentValue:c,currentDate:new Date,investments:r}}catch(c){return console.log(c),null}};function G(o,s,c){let r=0,x=0;return o.forEach(([f,t])=>{r+=f;const p=(s-t)/(365*24*60*60*1e3);x+=f/r*p}),(((c/r)**(1/x)-1)*100).toFixed(1)}function b(o,s,c,r){const x=(r-s)/31536e6;return(((c/o)**(1/x)-1)*100).toFixed(4)}const O=({deal:o,sector:s,currentValuation:c,userId:r})=>{const[x,d]=I.useState(0),[f,t]=I.useState(0),[p,S]=I.useState(0);return I.useEffect(()=>{(async()=>{const j=(await D(r)).reduce((u,h)=>{var n;const a=(n=h==null?void 0:h.investors)==null?void 0:n.find(l=>l.investerId===r);return u+parseInt((a==null?void 0:a.amount)||0,10)},0);S(j)})()},[r]),I.useEffect(()=>{o&&c&&(async()=>{var j;const i=(j=o==null?void 0:o.investors)==null?void 0:j.find(u=>u.investerId===r);if(i){const u=parseFloat((i==null?void 0:i.amount)||0)+parseFloat((i==null?void 0:i.fees)||0),h=parseFloat((i==null?void 0:i.carried)||0)/100,a=parseFloat((i==null?void 0:i.shareholding)||0),n=await P(u,a,c,o.currency,h),l=await T(u,a,c,o.currency,h);d(n),t(l)}})()},[c,r,o,p]),e.jsxs(e.Fragment,{children:[e.jsx("td",{children:x}),e.jsx("td",{children:s}),e.jsx("td",{children:f})]})},H=({setIsNew:o,company:s,deals:c,userId:r})=>{var f;const x=F(),d=(f=M())==null?void 0:f.user;return e.jsx("div",{className:"pop",children:e.jsxs("div",{className:"pop-body col-md-10",children:[e.jsx("div",{className:"text-end",children:e.jsx(m,{onClick:()=>o(t=>!t),className:"cursor-pointer",size:30})}),e.jsx("div",{className:"",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col text-uppercase ",children:" "}),e.jsx("th",{scope:"col text-uppercase ",children:" DEAL NAME"}),e.jsx("th",{scope:"col text-uppercase ",children:"ASSET ClASS "}),e.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT DATE"}),e.jsx("th",{scope:"col text-uppercase ",children:" INVESTMENT"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(LOSS)"}),e.jsx("th",{scope:"col text-uppercase ",children:"SECTOR"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),e.jsx("th",{scope:"col text-uppercase ",children:"WEIGHT "})]})}),e.jsx("tbody",{children:c==null?void 0:c.map((t,p)=>{var S,N,i,j,u,h,a,n,l;return e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{onClick:()=>x("about",{state:s==null?void 0:s._id}),className:" ",style:{width:"50px",aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:R+(s==null?void 0:s.profile)||(s==null?void 0:s.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize",children:s==null?void 0:s.name}),e.jsx("td",{children:(S=s==null?void 0:s.dealSummary)==null?void 0:S.asset}),e.jsx("td",{children:t==null?void 0:t.investedDate}),e.jsxs("td",{children:[" ",C((t==null?void 0:t.investors)&&((i=(N=t==null?void 0:t.investors)==null?void 0:N.find(g=>g.investerId===(d==null?void 0:d._id)))==null?void 0:i.amount)||(t==null?void 0:t.investors)&&((u=(j=t==null?void 0:t.investors)==null?void 0:j.find(g=>g.investerId===r))==null?void 0:u.amount))]}),e.jsx(O,{deal:t,currentValuation:(h=s==null?void 0:s.dealSummary)==null?void 0:h.currentValuation,userId:r||(d==null?void 0:d._id),sector:(a=s==null?void 0:s.dealSummary)==null?void 0:a.sector}),e.jsx("td",{children:e.jsx(_,{initialInvestment:(t==null?void 0:t.investors)&&((l=(n=t==null?void 0:t.investors)==null?void 0:n.find(g=>g.investerId===(r||(d==null?void 0:d._id))))==null?void 0:l.amount),investmentDate:t==null?void 0:t.investedDate,currentValue:t==null?void 0:t.currentValue})}),e.jsx("td",{children:t==null?void 0:t.weight})]},p)})})]})})]})})},_=({initialInvestment:o,investmentDate:s,currentValue:c})=>{const[r,x]=I.useState(0);return I.useEffect(()=>{x(b(parseInt(o||0),new Date(s),parseInt(c||0),new Date))},[o,s,c]),e.jsxs(e.Fragment,{children:[" ",r]})},W=({deals:o,sector:s,currentValuation:c,userId:r})=>{const[x,d]=I.useState(0),[f,t]=I.useState(0),[p,S]=I.useState(0),N=async()=>{const j=(await D(r)).reduce((u,h)=>{var n;const a=(n=h==null?void 0:h.investors)==null?void 0:n.find(l=>l.investerId===r);return u+parseInt((a==null?void 0:a.amount)||0)},0);S(j)};return I.useEffect(()=>{const i=async()=>{var h;let j=0,u=0;for(const a of o){const n=(h=a==null?void 0:a.investors)==null?void 0:h.find(l=>l.investerId===r);if(n){const l=parseInt((n==null?void 0:n.amount)||0)+parseFloat((n==null?void 0:n.fees)||0),g=parseFloat((n==null?void 0:n.carried)||0),E=parseFloat((n==null?void 0:n.shareholding)||0),w=await P(l,E,c,a.currency,g/100),A=await T(l,E,c,a.currency,g/100);j+=w,u+=A}}d(j),t(u)};N().then(()=>i())},[c,r,o]),e.jsxs(e.Fragment,{children:[e.jsx("td",{children:x}),e.jsx("td",{children:s}),e.jsx("td",{children:f})]})};export{H as D,W as N,G as c,Y as p};
